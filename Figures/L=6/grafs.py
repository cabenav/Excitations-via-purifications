import numpy as np
import random
import pickle
import gzip as gz
import csv
from copy import copy
import matplotlib.pyplot as plt
import pickle
from scipy import interpolate
from scipy.interpolate import make_lsq_spline, BSpline
from scipy.interpolate import make_interp_spline
from scipy.interpolate import Rbf, InterpolatedUnivariateSpline
from scipy.interpolate import interp1d

nf = 15


l1 = [[-2.00000000e+00,2.00000000e+00,3.00000000e+00,-3.00000000e+00,-3.00000000e+00,3.00000000e+00,-1.00000000e+00,-1.00000000e+00,1.00000000e+00,1.00000000e+00,1.86470938e-15,-1.40322342e-15,-1.28636820e-18,-1.13272247e-16,-1.11032642e-16],[1.62732662e+00,3.19036225e+00,3.18680359e+00,6.69049421e-01,-6.05588805e-01,1.61163386e+00,1.90812652e-03,-6.19178644e-01,1.00536711e+00,-2.86717714e+00,6.86184569e-01,1.65156916e-03,2.53078413e+00,-1.55284364e+00,-2.86628302e+00],
[2.41745834e+00,3.55885542e+00,3.55879641e+00,1.20498449e+00,-4.13218634e-01,2.42596060e+00,3.13946468e-04,-4.19321339e-01,2.02009572e+00,-2.78268687e+00,1.21576794e+00,5.12127844e-03,3.21800358e+00,-1.22925780e+00,-2.78087308e+00],
[3.32351907e+00,4.11013588e+00,4.11175461e+00,1.60039820e+00,-2.98501707e-01,3.31117633e+00,-2.59174668e-03,-3.05738622e-01,2.99979303e+00,-2.72525527e+00,1.61569795e+00,-1.29344327e-03,3.97975543e+00,-9.93833697e-01,-2.72501601e+00],
[4.24034364e+00,4.82759091e+00,4.82696776e+00,1.84918079e+00,-2.33919951e-01,4.25231041e+00,-1.19350639e-03,-2.36177175e-01,4.00102832e+00,-2.68399151e+00,1.85730391e+00,3.61766637e-05,4.81196286e+00,-8.27657374e-01,-2.68378525e+00],
[5.19457584e+00,5.64732185e+00,5.64695488e+00,2.00008974e+00,-1.91786518e-01,5.21050326e+00,-3.91607332e-04,-1.92699677e-01,5.00411760e+00,-2.65315946e+00,2.00777614e+00,-2.45415441e-04,5.68057485e+00,-7.00496021e-01,-2.65313544e+00],
[6.16542294e+00,6.52948135e+00,6.52933251e+00,2.09502967e+00,-1.61185510e-01,6.18870961e+00,2.86129070e-05,-1.63155209e-01,5.99082288e+00,-2.62913969e+00,2.11354316e+00,-1.46535389e-04,6.57419081e+00,-6.03833734e-01,-2.62910086e+00],
[7.14473676e+00,7.44728724e+00,7.44766971e+00,2.15883385e+00,-1.39018885e-01,7.16907035e+00,1.23114592e-04,-1.41181795e-01,6.97534354e+00,-2.61002285e+00,2.19257453e+00,-4.10641144e-04,7.49366775e+00,-5.28896865e-01,-2.60977580e+00],
[8.12714825e+00,8.38614239e+00,8.38761514e+00,2.20205347e+00,-1.21777653e-01,8.15337623e+00,5.55124186e-04,-1.25101045e-01,7.96497606e+00,-2.59424204e+00,2.24706290e+00,2.11122076e-03,8.43275981e+00,-4.69055269e-01,-2.59362459e+00],
[9.11144350e+00,9.34149874e+00,9.34167628e+00,2.23585738e+00,-1.09148923e-01,9.13802565e+00,2.02971142e-03,-1.13848600e-01,8.97040509e+00,-2.58166904e+00,2.27565815e+00,3.91230124e-04,9.38905424e+00,-4.19710595e-01,-2.58166282e+00],
[1.01007715e+01,1.03053804e+01,1.03057805e+01,2.26189135e+00,-9.82802710e-02,1.01266955e+01,2.32946071e-03,-1.03282564e-01,9.96183269e+00,-2.57075704e+00,2.30886886e+00,-3.97864988e-04,1.03498060e+01,-3.80193400e-01,-2.57044518e+00]]


l2 = [[-2.00000000e+00+2.65083360e-17j,2.00000000e+00+4.31813497e-17j,3.00000000e+00+4.13217274e-17j,-3.00000000e+00-1.35661518e-17j,-3.00000000e+00-5.55111512e-17j,3.00000000e+00+2.21854870e-17j,-1.00000000e+00-1.08419689e-17j,-1.00000000e+00-2.84543778e-17j,1.00000000e+00-2.51534904e-17j,1.00000000e+00+2.53432258e-17j,1.86470938e-15+3.26488145e-17j,-1.40322342e-15+1.81156191e-17j,-1.28636820e-18+1.11229389e-16j,-1.13272247e-16-7.90586708e-17j,-1.11032642e-16-1.53148502e-19j],
[1.00000000e+00+7.97296296e-17j,-1.56155281e+00-6.02038078e-18j,2.56155281e+00-1.04306513e-16j,3.03371065e-16-4.67107517e-17j,-5.78754844e-16+1.64513885e-16j,-2.86781598e+00+1.04826814e-23j,-2.86781598e+00+9.88792381e-17j,3.21758071e+00-1.95250217e-16j,
3.21758071e+00-1.14952535e-16j,-6.18033989e-01-5.55111512e-17j,-6.18033989e-01+1.38777878e-17j,1.61803399e+00+6.93860685e-17j,
1.61803399e+00+1.16768574e-16j,6.50235267e-01-1.38777878e-16j,6.50235267e-01-1.62413485e-16j],[2.00000000e+00+1.59459259e-16j,-1.23606798e+00-5.03911466e-17j,3.23606798e+00-1.16932128e-16j,3.54065793e-16-1.11069023e-16j,-1.18608891e-16+2.87782415e-16j,-2.78308827e+00+5.55111502e-17j,-2.78308827e+00+3.95516953e-16j,3.57802063e+00-5.76669291e-16j,
-4.14213562e-01-1.24900090e-16j,-4.14213562e-01+2.77555756e-17j,3.57802063e+00-1.66027545e-16j,2.41421356e+00-1.38777871e-16j,
2.41421356e+00+7.48099499e-17j,1.20506764e+00-1.94289029e-16j,1.20506764e+00-2.22044605e-16j],[3.00000000e+00+2.39188889e-16j,-1.00000000e+00-1.08300044e-16j,1.96353263e-16-1.62203925e-16j,-6.36077303e-16+1.69664313e-16j,4.00000000e+00-7.03678287e-17j,-2.72544874e+00-1.66526345e-16j,-2.72544874e+00+5.03069808e-17j,1.60146556e+00-2.71613575e-17j,
-3.02775638e-01+1.52655666e-16j,-3.02775638e-01-2.87638836e-16j,1.60146556e+00-1.17303412e-16j,4.12398318e+00-1.11022302e-16j,
4.12398318e+00-6.42281367e-16j,3.30277564e+00-8.32667269e-17j,3.30277564e+00-4.58617519e-17j],[4.00000000e+00+3.18918518e-16j,-8.28427125e-01-1.68924444e-16j,2.55155210e-16-2.09647035e-16j,-5.98584341e-16+4.65205148e-16j,-2.68415920e+00-1.21430640e-16j,-2.68415920e+00-1.29995840e-16j,4.82842712e+00-3.57627810e-16j,-2.36067977e-01+1.44849410e-16j,
-2.36067977e-01+1.33854923e-16j,1.84938116e+00+9.46329748e-23j,1.84938116e+00-2.77555756e-17j,4.23606798e+00-3.33066914e-16j,
4.23606798e+00+9.88507778e-16j,4.83477804e+00+3.73842320e-16j,4.83477804e+00+7.44907812e-18j],[5.00000000e+00+3.98648148e-16j,-7.01562119e-01-1.21628093e-16j,2.59628033e-16-2.68573581e-16j,-1.67730240e-15+8.52478307e-16j,5.70156212e+00-2.79190657e-16j,-2.65331193e+00-4.99600361e-16j,-2.65331193e+00+3.70363462e-16j,5.19258240e+00-1.69292744e-16j,
2.00000000e+00-6.66133815e-16j,2.00000000e+00-4.99600361e-16j,5.19258240e+00+7.96646629e-16j,5.65331193e+00-4.63221535e-16j,
5.65331193e+00+1.32237084e-16j,-1.92582404e-01+8.32667268e-17j,-1.92582404e-01+2.42861287e-16j],[6.00000000e+00+4.78377778e-16j,-6.05551275e-01-1.87885117e-16j,3.96151874e-16-2.72530338e-16j,-4.02451444e-16+8.96360347e-16j,6.60555128e+00-3.03001419e-17j,-2.62947240e+00+4.44194596e-16j,-2.62947240e+00+1.38777878e-17j,2.09527928e+00-8.74538018e-16j,
2.09527928e+00-6.24500451e-16j,-1.62277660e-01+3.22658567e-16j,-1.62277660e-01-6.48217374e-17j,6.16227766e+00+2.08166817e-16j,
6.16227766e+00+2.87047607e-16j,6.53419311e+00+4.10965474e-23j,6.53419311e+00+4.77048956e-18j],[7.00000000e+00+5.58107407e-16j,-5.31128874e-01-3.92300469e-16j,7.53112887e+00+2.29255712e-17j,-3.39573803e-17-2.88324354e-16j,-6.55708636e-16+8.31868423e-16j,-2.61053599e+00-2.22044808e-16j,-2.61053599e+00+6.13441589e-16j,2.15914811e+00-1.27559999e-15j,
2.15914811e+00-6.20597324e-16j,7.45138788e+00-9.98352469e-16j,7.45138788e+00-7.59640746e-16j,7.14005494e+00+5.54847079e-17j,
7.14005494e+00-8.28052633e-16j,-1.40054945e-01+3.05311332e-16j,-1.40054945e-01+1.11875434e-15j],[8.00000000e+00+6.37837037e-16j,-4.72135955e-01-4.15627055e-16j,-1.14037770e-17-1.98188655e-16j,-1.75094586e-16+7.10342564e-16j,8.47213595e+00+8.97420621e-17j,-2.59515183e+00+1.66532622e-16j,
-2.59515183e+00+2.15105711e-16j,2.20431179e+00+0.00000000e+00j,2.20431179e+00-8.88178420e-16j,8.12310563e+00+1.57503157e-22j,
8.12310563e+00+2.97396656e-16j,8.39084004e+00-4.44089210e-16j,8.39084004e+00-9.08995101e-16j,-1.23105626e-01+1.25333771e-16j,
-1.23105626e-01+1.02754414e-16j],[9.00000000e+00+7.17566666e-16j,-4.24428901e-01-3.90718508e-16j,
-5.50429718e-16-1.77758114e-16j,5.07557546e-16+7.51769560e-16j,9.42442890e+00-7.08670681e-16j,-2.58241756e+00+2.49800170e-16j,
-2.58241756e+00-4.77048956e-16j,9.10977223e+00-2.10695826e-16j,2.23769493e+00-9.11632671e-16j,2.23769493e+00-1.44155333e-16j,
9.10977223e+00+5.53453404e-16j,9.34472262e+00-3.35040834e-21j,9.34472262e+00+5.50341023e-16j,-1.09772229e-01+5.94142791e-17j,
-1.09772229e-01+9.85268724e-17j],[1.00000000e+01+7.97296296e-16j,-3.85164807e-01+2.40270912e-16j,-2.90251737e-16-5.63083032e-16j,-2.17650397e-15+1.35607278e-15j,
1.03851648e+01-4.61902341e-16j,-2.57170949e+00-4.85722249e-17j,-2.57170949e+00+7.71951947e-17j,1.00990195e+01-1.15160897e-16j,
2.26327034e+00-2.04184020e-15j,2.26327034e+00+1.38341431e-16j,1.00990195e+01-1.84269167e-16j,1.03084391e+01-8.88179819e-16j,
1.03084391e+01-2.78423118e-16j,-9.90195136e-02+6.01081684e-16j,-9.90195136e-02+3.19622800e-16j]]

list1 = np.array(l1)
list2 = np.array(l2)

FI1 =[0,1,2,3,4,5, 6, 7, 8, 9,10]
FI1 = np.array(FI1)


eigenor= np.zeros((11,nf))
eigennumor = np.zeros((11,nf))
gap = np.zeros((11,nf-1))
gapnum = np.zeros((11,nf-1))

for u in range(11):
   eigenor[u] = list(list2.real[u])
   eigenor[u].sort() 
   eigennumor[u] = list(list1.real[u])
   eigennumor[u].sort()  
   for j in range(5):
      gap[u,j] = eigenor[u,j+1]-eigenor[u,1]
      gapnum[u,j] = eigennumor[u][j+1]-eigennumor[u][1]
   for j in range(5,nf-1):
      gap[u,j] = eigenor[u,j+1]-eigenor[u,0]
      gapnum[u,j] = eigennumor[u][j+1]-eigennumor[u][0]
 
plt.rc('axes', labelsize=15)
plt.rc('font', size=15)  
for i in range(nf-1):
   plt.plot(FI1, eigenor[:,i],'r-')
   plt.plot(FI1, eigennumor[:,i],'ko',mfc='none')
plt.plot(FI1, eigenor[:,nf-1],'r-', mfc='none',label='exact')
plt.plot(FI1, eigennumor[:,nf-1],'ko', mfc='none',label='UCCSD')
plt.legend(prop={"size":15},loc='upper left')
plt.xlabel("$U/t$")
plt.show()

plt.rc('axes', labelsize=15)
plt.rc('font', size=15) 
for i in range(nf-2):
   plt.plot(FI1, gap[:,i],'r-')
   plt.plot(FI1, gapnum[:,i],'ko',mfc='none') 
plt.plot(FI1, gap[:,nf-2],'r-', mfc='none',label='exact')
plt.plot(FI1, gapnum[:,nf-2],'ko',mfc='none',label='UCCSD')
plt.legend(prop={"size":15},loc='upper left')
plt.xlabel("$U/t$")
plt.show()

def func(vec, vec1):
   disT=0
   for j in range(len(vec)):
      dis = 1
      for i in range(len(vec1)):
        # if (float(abs((vec[j].real - vec1[i].real)/vec1[i].real)))**2 < dis:
         #    dis = (float(abs((vec[j].real - vec1[i].real)/vec1[i].real)))**2
         if (float(abs((vec[j].real - vec1[i].real)))) < dis:
             dis = (float(abs((vec[j].real - vec1[i].real))))
      disT += dis
   return disT/len(vec1)

error = np.zeros(11)
errorT = 0
for i in range(11):
   error[i] = func(gap[i],gapnum[i])   
   print(func(gap[i],gapnum[i]))
   errorT += error[i]

print("Total error: ", errorT/11)

plt.plot(FI1, error,'ko',mfc='none',label='error')
plt.legend(prop={"size":15},loc='lower right')
plt.xlabel("$U/t$")
plt.show()


